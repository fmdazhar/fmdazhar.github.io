<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Peg-in-Hole Simulation &amp; RL Platform | Mohammed Azharudeen Farook Deen </title> <meta name="author" content="Mohammed Azharudeen Farook Deen"> <meta name="description" content="Internship at Fraunhofer IPA - 2"> <meta name="keywords" content="robotics, deep learning, reinforcement learning, control engineering, Isaac Sim, MuJoCo, ROS, ROS2, MPC, Python, C++, humanoid robots, quadrupeds, real-time systems, UR5e, Unitree A1"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8E%93&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fmdazhar.github.io/projects/9_project/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <script src="/assets/js/scramble.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Mohammed Azharudeen</span> Farook Deen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/education/">education </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/my_resume.pdf"> cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Peg-in-Hole Simulation &amp; RL Platform</h1> <p class="post-description">Internship at Fraunhofer IPA - 2</p> </header> <article> <p>A <strong>sample-efficient framework</strong> for learning high-precision insertion:<br> a UR5e + Robotiq Hand-E gripper, full contact dynamics in MuJoCo, synchronized multi-camera vision, configurable classical controllers, and an end-to-end RLPD-style training pipeline.</p> <hr> <p><strong>See also:</strong><br> <a href="/projects/8_project/">Modular Control Pipeline for Real UR5e Manipulator</a></p> <hr> <h2 id="1--simulation-environment">1 Simulation Environment</h2> <ul> <li>MuJoCo scene with calibrated <strong>UR5e arm</strong>, <strong>Hand-E gripper</strong>, male connector, and a female port.</li> <li>Realistic inertia, joint limits, fingertip collisions, and contact sensors.</li> <li>Plug-and-play <strong>Gymnasium</strong> interface, difficulty presets, headless/off-screen rendering, and Docker packaging for reproducibility.</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/ipa.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls=""></video> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-3-480.webp 480w,/assets/img/mujoco-3-800.webp 800w,/assets/img/mujoco-3-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Peg-in-hole scene" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Heuristic based real world scene for force-sensitive insertion. Right: learning-based Gymnasium simulation environment used to solve this task. </div> <hr> <h2 id="11--difficulty-presets">1.1 Difficulty Presets</h2> <p>The environment ships with <strong>three ready-to-use difficulty presets</strong> so you can benchmark algorithms under progressively tougher conditions without touching low-level code.</p> <table> <thead> <tr> <th>Level</th> <th>Scenario Highlights</th> <th>Use-Case</th> </tr> </thead> <tbody> <tr> <td><strong>Easy</strong></td> <td>Fixed port orientation, modest XYZ randomization, and a rich observation vector (TCP pose, velocity, force-torque, connector &amp; port poses).</td> <td>Rapid prototyping &amp; controller tuning.</td> </tr> <tr> <td><strong>Medium</strong></td> <td>Adds in-plane &amp; vertical port shifts plus reduced observations; the agent still sees force-torque and connector pose but must cope with larger spatial variability.</td> <td>Early learning-from-pixels or demo-bootstrapped RL experiments.</td> </tr> <tr> <td><strong>Hard</strong></td> <td>Full 6-DoF port orientation randomization and a minimalist observation set (no connector or port pose), stressing contact sensing and visual feedback.</td> <td>Final performance evaluation &amp; sim-to-real robustness tests.</td> </tr> </tbody> </table> <p><br></p> <p>Switching level is as simple as selecting the corresponding Gymnasium ID in your training script, everything else (rendering, logging, reward structure) stays consistent.</p> <hr> <h2 id="2--modular-control-stack">2 Modular Control Stack</h2> <ul> <li> <strong>Configurable PD/Impedance</strong> controller with inverse-dynamics, pseudo-inverse, and Jacobian-transpose modes.</li> <li>Real-time safety: joint, velocity &amp; acceleration clipping, workspace envelope.</li> <li>Live-tunable gains via a lightweight Qt UI with sliders and force-vector overlay.</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-11-480.webp 480w,/assets/img/mujoco-11-800.webp 800w,/assets/img/mujoco-11-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-11.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Force-vector overlay" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Live telemetry dashboard with plots track joint positions, velocities, accelerations, TCP pose error, and cumulative reward. The dashboard—implemented with a lightweight UI—enabled immediate diagnosis of issues. Interactive overlay of on-screen sliders permit live tuning of proportional/derivative gains and compliance settings. This tool was essential for quickly damping oscillations during controller testing. </div> <hr> <h2 id="3--interactive-tele-op--data-capture">3 Interactive Tele-op &amp; Data Capture</h2> <ul> <li> <strong>SpaceMouse</strong> and keyboard drivers for human-in-the-loop manipulation.</li> <li>Synchronized RGB video &amp; state logs, plus scripted rollout presets for reproducible demonstrations.</li> <li>Automatic test-suite validates every Docker build with a short rollout and frame dump.</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-4-480.webp 480w,/assets/img/mujoco-4-800.webp 800w,/assets/img/mujoco-4-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Peg-in-hole scene" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-5-480.webp 480w,/assets/img/mujoco-5-800.webp 800w,/assets/img/mujoco-5-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Peg-in-hole scene" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-6-480.webp 480w,/assets/img/mujoco-6-800.webp 800w,/assets/img/mujoco-6-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Peg-in-hole scene" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Pre-defined camera presets and workspace envelope. Multiple MuJoCo cameras give consistent viewpoints for data collection and debugging. The translucent red cuboid marks the safety workspace; the opaque blue cube marks the task goal pose, Real-time force vectors (red arrows) emanate from the tool-centre-point </div> <hr> <h2 id="4--vision-observations">4 Vision Observations</h2> <p>Two virtual cameras—front-view &amp; wrist—deliver 640 × 480 RGB frames each timestep, alongside proprioceptive state.<br> Wrappers support <strong>frame stacking</strong>, normalization, and video logging.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-9-480.webp 480w,/assets/img/mujoco-9-800.webp 800w,/assets/img/mujoco-9-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-9.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Multi-camera image observations" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Multi-view image observations integrated into the Render. The vertical strip on the right contains the additional image observations from wrist and front cameras to the agent. Together, these streams expand the observation space from purely proprioceptive state vectors to pixel-level visual input, paving the way for pixel-based SAC experiments. </div> <hr> <h2 id="5--rlpd-style-training-pipeline">5 RLPD-Style Training Pipeline</h2> <ul> <li> <strong>Replay buffer</strong> mixes expert demos with online rollouts, supports prioritized &amp; uniform sampling.</li> <li>JAX/Flax <strong>Ensemble SAC</strong> learner with convolutional encoders for images and FC nets for states.</li> <li>Actor–Learner split enables asynchronous collection; Docker image ships with GPU + virtual-display support.</li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mujoco-10-480.webp 480w,/assets/img/mujoco-10-800.webp 800w,/assets/img/mujoco-10-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mujoco-10.png" class="img-fluid rounded z-depth-1 " width="100%" height="auto" title="Multi-camera image observations" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Human-in-the-loop reinforcement-learning pipeline we plan to adopt, inspired by the HIL-SERL[1], [2] approach. </div> <hr> <h2 id="takeaways--next-steps">Takeaways &amp; Next Steps</h2> <ul> <li> <strong>Reproducibility first:</strong> Docker, tests, and clear config dictionaries cut onboarding time to minutes.</li> <li> <strong>Data matters:</strong> 20 high-quality demos were enough to bootstrap RL; diverse misalignment demos are the next bottleneck.</li> <li> <strong>Future work:</strong> domain randomization for sim-to-real transfer, Vision Transform-based encoders, policy distillation to real UR5e.</li> </ul> <hr> <h3 id="references">References</h3> <p>[1] J. Luo et al., ‘SERL: A Software Suite for Sample-Efficient Robotic Reinforcement Learning’, Feb. 12, 2024, arXiv: arXiv:2401.16013. Accessed: Jul. 04, 2024. [Online]. Available: http://arxiv.org/abs/2401.16013</p> <p>[2] J. Luo, C. Xu, J. Wu, and S. Levine, ‘Precise and Dexterous Robotic Manipulation via Human-in-the-Loop Reinforcement Learning’.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Mohammed Azharudeen Farook Deen. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 03, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>